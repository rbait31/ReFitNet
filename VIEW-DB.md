# Database Viewer (view-db)

Тестовая программа для просмотра и управления данными в базе данных PostgreSQL через веб-интерфейс.

## Возможности

- ✅ Выбор между локальной и рабочей БД
- ✅ Просмотр списка всех таблиц
- ✅ Просмотр данных таблиц с пагинацией (20 записей на страницу)
- ✅ CRUD операции:
  - **Create** - создание новых записей
  - **Read** - просмотр данных
  - **Update** - редактирование записей
  - **Delete** - удаление записей

## Использование

### 1. Настройка переменных окружения

В файле `.env` укажите:

```env
# Локальная БД
DATABASE_URL="postgresql://..."

# Рабочая БД (опционально)
DATABASE_URL_PRODUCTION="postgresql://..."
```

Если `DATABASE_URL_PRODUCTION` не указан, будет использоваться `DATABASE_URL` для обеих БД.

### 2. Запуск приложения

```bash
npm run dev
```

### 3. Открыть Database Viewer

Перейдите по адресу: `http://localhost:3000/view-db`

## Интерфейс

### Шаг 1: Выбор БД
- Выберите **Local Database** или **Production Database**
- Нажмите **Continue**

### Шаг 2: Список таблиц
- Отображается список всех доступных таблиц:
  - Users
  - Notes
  - Categories
  - Prompts
  - Tags
  - Votes
- Нажмите **Open** на нужной таблице

### Шаг 3: Просмотр и редактирование таблицы
- Просмотр данных с пагинацией
- **+ Create New** - создание новой записи
- **Edit** - редактирование записи (inline)
- **Delete** - удаление записи (с подтверждением)
- Навигация по страницам внизу таблицы

## API Routes

### GET `/api/db/tables?db={local|production}`
Получить список таблиц с количеством записей

### GET `/api/db/table?db={local|production}&table={tableName}&page={page}`
Получить данные таблицы с пагинацией

### POST `/api/db/table?db={local|production}&table={tableName}`
Создать новую запись

### PUT `/api/db/table?db={local|production}&table={tableName}`
Обновить запись (требуется `id` в теле запроса)

### DELETE `/api/db/table?db={local|production}&table={tableName}&id={id}`
Удалить запись

## Технические детали

- Использует Prisma Client для работы с БД
- Динамическое подключение к разным БД через `lib/db-factory.ts`
- Клиентские компоненты (Client Components) для интерактивности
- Suspense boundaries для корректной работы с `useSearchParams`

## Безопасность

⚠️ **Внимание**: Эта программа предназначена для разработки и тестирования. Не используйте её в продакшене без дополнительной защиты (аутентификация, авторизация, валидация данных).

